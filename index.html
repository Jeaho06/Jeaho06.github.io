<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title data-i18n-key="lobby_title">반칙 오목 - 로비</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/lobby.css">
    <link rel="stylesheet" href="/css/shop.css">
    <link rel="stylesheet" href="/css/inventory.css">
    <link rel="stylesheet" href="/css/skins.css">
    <link rel="stylesheet" href="css/themes/summer-theme.css"> 
</head>
<body>
    <audio id="bgm" loop src="sounds/SummerGoes.wav"></audio>

    <div id="background-watermark"></div>

    <div class="main-content-wrapper">
        <div class="lobby-container">
            <header class="lobby-header">
                <div id="user-display" style="display: none;">
                    <span id="nickname-display"></span>
                </div>
                <div id="guest-display">
                    <button id="open-login-modal-btn" data-i18n-key="login_btn">로그인</button>
                </div>
                <div class="global-controls">
                    <button id="language-button" data-i18n-key="language_btn">언어</button>
                </div>
            </header>

            <main class="lobby-main">
                <aside class="lobby-sidebar">
                    <h2 data-i18n-key="menu_title">메뉴</h2>
                    <nav class="lobby-nav">
                        <button id="open-shop-btn" class="nav-button" data-i18n-key="shop_btn">상점</button>
                        <button id="lobby-profile-button" class="nav-button" data-i18n-key="profile_btn">프로필</button>
                        <button id="lobby-update-button" class="nav-button" data-i18n-key="updates_btn">업데이트</button>
                        <button class="nav-button" data-i18n-key="ranking_btn">랭킹</button>
                        <button id="inventory-btn" class="nav-button" data-i18n-key="inventory_btn">🎒 인벤토리</button>
                    </nav>
                    <div class="user-stats-summary">
                        <h3 data-i18n-key="my_info_summary">내 정보 요약</h3>
                        <p><strong id="summary-nickname">Guest</strong></p>
                        <p><span data-i18n-key="stat_level">레벨</span>: <span id="stat-level">1</span></p>
                        <p><span data-i18n-key="stats_wins">승리</span>: <span id="stat-wins">0</span></p>
                        <p><span data-i18n-key="stats_losses">패배</span>: <span id="stat-losses">0</span></p>
                        <p><span data-i18n-key="profile_luna_title">보유 루나</span>: <span id="stat-luna">100</span></p>
                    </div>
                </aside>
                <section class="lobby-content">
                    <div class="start-panel">
                        <div class="game-title">
                            <h1 data-i18n-key="game_title">반칙 오목</h1>
                            <p data-i18n-key="game_subtitle">AI와의 짜릿한 반칙 승부</p>
                        </div>
                        <button id="start-game-btn" data-i18n-key="start_game_btn">게임 시작</button>
                    </div>
                </section>
            </main>
        </div>
        <div id="level-bar-container">
            <div id="level-bar-background">
                <div id="level-bar-fill"></div>
                <span id="level-bar-text"></span>
            </div>
        </div>
    </div>
    
    <div id="footer-placeholder"></div>
    <div id="popups-placeholder"></div>

    <script type="module">
        import { loadComponents } from './js/componentLoader.js';
        import { initializeLobby } from './js/lobby.js';
        import { initializeApp } from './js/common.js';
        // 앱을 시작하는 비동기 함수
        async function startApp() {
            // 1. 공용 HTML (팝업, 푸터)을 먼저 화면에 로드합니다.
            await loadComponents();
            // 2. 공용 스크립트(인증, 언어, 공용 팝업 제어)를 초기화합니다.
            initializeApp();
            // 3. 마지막으로 로비 전용 스크립트(게임 시작 버튼 등)를 초기화합니다.
            initializeLobby();
        }

        // 앱 시작
        startApp();
    </script>
</body>
</html>